<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeliÅŸmiÅŸ Roket Test Ä°stasyonu</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #0284c7; --dark: #0f172a; --bg: #f1f5f9; --accent: #f59e0b; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--dark); padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { max-width: 1100px; width: 100%; display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        h1 { grid-column: 1 / -1; text-align: center; color: var(--primary); }
        label { display: block; margin-top: 10px; font-weight: 600; font-size: 0.9rem; }
        input, select { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #cbd5e1; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; margin-top: 20px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        button:hover { background: #0ea5e9; }
        .result-box { margin-top: 20px; padding: 15px; background: #e0f2fe; border-radius: 8px; border-left: 5px solid var(--primary); }
        .val-display { font-size: 1.5rem; font-weight: bold; color: var(--primary); }
        .product-btn { display: block; margin-top: 8px; padding: 10px; text-decoration: none; color: white; background: #334155; border-radius: 6px; text-align: center; font-size: 0.9rem; }
        .product-btn:hover { opacity: 0.9; }
        .details { font-size: 0.8rem; color: #64748b; margin-top: 10px; white-space: pre-line; }
        
        @media (max-width: 768px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <h1>ğŸš€ SoÄŸuk Gaz Ä°tki & Load Cell SeÃ§ici</h1>

    <div class="container">
        <div class="card">
            <h3>âš™ï¸ Sistem Parametreleri</h3>
            
            <label>TÃ¼p BasÄ±ncÄ± (Bar)</label>
            <input type="number" id="pressure" value="300" placeholder="Ã–rn: 300">
            
            <label>NozÃ¼l BoÄŸaz Ã‡apÄ± (mm)</label>
            <input type="number" id="diameter" value="2.0" step="0.1" placeholder="Ã‡Ä±kÄ±ÅŸ deÄŸil, en dar yer">
            
            <label>NozÃ¼l SayÄ±sÄ±</label>
            <input type="number" id="count" value="4">

            <label>GÃ¼venlik KatsayÄ±sÄ± (Safety Factor)</label>
            <select id="safety">
                <option value="1.5">1.5x (Minimum)</option>
                <option value="2.0" selected>2.0x (EndÃ¼striyel Standart)</option>
                <option value="3.0">3.0x (YÃ¼ksek GÃ¼venlik)</option>
            </select>

            <button onclick="calculateSystem()">HESAPLA & ÃœRÃœN BUL</button>

            <div id="results" style="display:none;">
                <div class="result-box">
                    <div>Tahmini Toplam Ä°tki:</div>
                    <div class="val-display"><span id="thrustN">0</span> N (<span id="thrustKg">0</span> kgf)</div>
                </div>
                
                <div class="result-box" style="background: #fffbeb; border-color: var(--accent);">
                    <div>Ã–nerilen Load Cell Kapasitesi:</div>
                    <div class="val-display" style="color: var(--accent);" id="recCap">0 kg</div>
                    <div style="font-size:0.85rem; margin-top:5px;">(GÃ¼venlik katsayÄ±sÄ± dahil, piyasa standardÄ±na yuvarlandÄ±)</div>
                </div>

                <h4>ğŸ›’ ÃœrÃ¼n Arama Linkleri:</h4>
                <div id="links"></div>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ“ˆ Ä°tki Zaman GrafiÄŸi (SimÃ¼lasyon)</h3>
            <div style="height: 300px;">
                <canvas id="chart"></canvas>
            </div>
            
            <button style="background: #10b981; margin-top: 10px;" onclick="runSimulation()">Test AteÅŸlemesi BaÅŸlat ğŸ’¥</button>

            <div class="details" id="mathLog">
                Hesaplama detayÄ± burada gÃ¶rÃ¼necek...
            </div>
        </div>
    </div>

    <script>
        // --- GRAFÄ°K AYARLARI ---
        const ctx = document.getElementById('chart').getContext('2d');
        let myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Ä°tki (Newton)',
                    data: [],
                    borderColor: '#0284c7',
                    backgroundColor: 'rgba(2, 132, 199, 0.2)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, animation: false }
        });

        let calculatedForceN = 0;

        function calculateSystem() {
            // 1. Verileri Al
            const P_bar = parseFloat(document.getElementById('pressure').value);
            const D_mm = parseFloat(document.getElementById('diameter').value);
            const N_count = parseFloat(document.getElementById('count').value);
            const Safety = parseFloat(document.getElementById('safety').value);

            if (!P_bar || !D_mm || !N_count) { alert("LÃ¼tfen tÃ¼m deÄŸerleri girin!"); return; }

            // 2. FÄ°ZÄ°K HESABI (Cold Gas Thruster Equation)
            // F = Cf * P * At
            // P (Pascal) = Bar * 100,000
            // At (m2) = pi * r^2 * adet
            
            const P_pa = P_bar * 100000;
            const r_m = (D_mm / 1000) / 2; // YarÄ±Ã§ap (metre)
            const At_m2 = Math.PI * (r_m ** 2) * N_count; // Toplam BoÄŸaz AlanÄ±

            // Cf (Thrust Coefficient): SoÄŸuk gaz (Azot/Hava) iÃ§in 300 barda yaklaÅŸÄ±k 1.4 - 1.5 arasÄ±dÄ±r.
            // Biz gÃ¼venli tarafta kalmak iÃ§in 1.45 alÄ±yoruz.
            const Cf = 1.45; 

            calculatedForceN = Cf * P_pa * At_m2;
            const forceKg = calculatedForceN / 9.81;

            // 3. LOAD CELL SEÃ‡Ä°M MANTIÄI (Piyasa StandartlarÄ±na Yuvarlama)
            const reqCapacity = forceKg * Safety;
            const standards = [10, 20, 50, 100, 200, 500, 1000, 2000, 5000];
            
            let selectedStandard = standards.find(s => s >= reqCapacity);
            if (!selectedStandard) selectedStandard = "5000+";

            // 4. SONUÃ‡LARI YAZDIR
            document.getElementById('thrustN').innerText = calculatedForceN.toFixed(1);
            document.getElementById('thrustKg').innerText = forceKg.toFixed(1);
            document.getElementById('recCap').innerText = selectedStandard + " kg";
            document.getElementById('results').style.display = 'block';

            // 5. DETAYLI LOG (GÃ¼venilirlik iÃ§in)
            document.getElementById('mathLog').innerText = 
                `ğŸ“Œ HESAP DETAYI:\n` +
                `- BasÄ±nÃ§: ${P_pa.toLocaleString()} Pascal\n` +
                `- Toplam BoÄŸaz AlanÄ±: ${At_m2.toExponential(4)} mÂ²\n` +
                `- Teorik KatsayÄ± (Cf): ${Cf}\n` +
                `- FormÃ¼l: F = P * A * Cf\n` +
                `- Saf Ä°tki: ${(forceKg).toFixed(2)} kg\n` +
                `- GÃ¼venlikli Ä°htiyaÃ§ (${Safety}x): ${(reqCapacity).toFixed(2)} kg\n` +
                `-> Piyasa StandardÄ±: ${selectedStandard} kg seÃ§ildi.`;

            // 6. LÄ°NKLERÄ° OLUÅTUR
            createLinks(selectedStandard);
        }

        function createLinks(kgVal) {
            const div = document.getElementById('links');
            div.innerHTML = "";

            if (kgVal === "5000+") {
                div.innerHTML = "<div>Ã‡ok yÃ¼ksek kapasite! Ã–zel endÃ¼striyel sensÃ¶r aramalÄ±sÄ±nÄ±z.</div>";
                return;
            }

            // DoÄŸrudan arama sorgularÄ±
            const queries = [
                { site: "Robotistan", text: `Load Cell ${kgVal} kg`, url: `https://www.robotistan.com/arama?q=load+cell+${kgVal}+kg` },
                { site: "DirenÃ§.net", text: `YÃ¼k HÃ¼cresi ${kgVal}kg`, url: `https://www.direnc.net/arama?q=load+cell+${kgVal}kg` },
                { site: "Google AlÄ±ÅŸveriÅŸ", text: `S-Type Load Cell ${kgVal}kg`, url: `https://www.google.com/search?tbm=shop&q=s-type+load+cell+${kgVal}kg` }
            ];

            queries.forEach(q => {
                const a = document.createElement('a');
                a.className = 'product-btn';
                a.href = q.url;
                a.target = "_blank";
                a.innerText = `ğŸ” ${q.site}'da "${q.text}" Ara`;
                div.appendChild(a);
            });
        }

        // --- SÄ°MÃœLASYON ---
        function runSimulation() {
            if (calculatedForceN === 0) calculateSystem();
            
            myChart.data.labels = [];
            myChart.data.datasets[0].data = [];
            
            let time = 0;
            let currentF = calculatedForceN;
            
            // SimÃ¼lasyon dÃ¶ngÃ¼sÃ¼ (Blow-down effect)
            // Tank boÅŸaldÄ±kÃ§a basÄ±nÃ§ ve itki dÃ¼ÅŸer
            let interval = setInterval(() => {
                time += 0.1;
                
                // Ä°tki DÃ¼ÅŸÃ¼ÅŸ FormÃ¼lÃ¼ (BasitleÅŸtirilmiÅŸ Ã¼stel dÃ¼ÅŸÃ¼ÅŸ)
                // 300 bar -> 0 bar'a inmesi
                currentF = calculatedForceN * Math.exp(-0.2 * time); 

                // GÃ¼rÃ¼ltÃ¼ ekle (SensÃ¶r titremesi gibi)
                let noise = (Math.random() - 0.5) * (calculatedForceN * 0.02);
                
                let plotVal = currentF + noise;
                if(plotVal < 0) plotVal = 0;

                myChart.data.labels.push(time.toFixed(1));
                myChart.data.datasets[0].data.push(plotVal);

                // GrafiÄŸi kaydÄ±r
                if(myChart.data.labels.length > 50) {
                    myChart.data.labels.shift();
                    myChart.data.datasets[0].data.shift();
                }

                myChart.update();

                if (time > 15 || currentF < 10) clearInterval(interval);

            }, 100);
        }
    </script>
</body>
</html>

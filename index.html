<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ã–zel Ä°tki HesaplayÄ±cÄ± (Python Core)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #2563eb; --dark: #0f172a; --bg: #f8fafc; --accent: #f97316; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--dark); padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .main-wrapper { display: grid; grid-template-columns: 1fr 1.5fr; gap: 20px; max-width: 1100px; width: 100%; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .full-col { grid-column: 1 / -1; }

        h1 { color: var(--dark); text-align: center; width: 100%; margin-bottom: 5px; }
        .sub-text { text-align: center; color: #64748b; margin-bottom: 25px; font-size: 0.9rem; }

        label { display: block; font-weight: 600; margin-bottom: 5px; color: #334155; }
        input { width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; box-sizing: border-box; margin-bottom: 15px; }
        input:focus { border-color: var(--primary); outline: none; }

        button {
            width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 8px;
            font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        button:hover { background: #1d4ed8; }

        .result-box {
            background: #eff6ff; border: 1px solid #bfdbfe; padding: 20px; border-radius: 10px; text-align: center; margin-top: 20px;
        }
        .big-val { font-size: 2.5rem; font-weight: 800; color: var(--primary); }
        .small-val { font-size: 1.1rem; color: #1e40af; }

        .links { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .shop-btn {
            padding: 12px; text-decoration: none; background: white; border: 1px solid #cbd5e1; border-radius: 6px;
            color: var(--dark); font-weight: 600; display: flex; justify-content: space-between; transition: 0.2s;
        }
        .shop-btn:hover { border-color: var(--primary); color: var(--primary); }

        @media(max-width: 768px) { .main-wrapper { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <h1>ğŸš€ Ã–zel Ä°tki Sistemi HesaplayÄ±cÄ±</h1>
    <p class="sub-text">KullanÄ±cÄ± TanÄ±mlÄ± Python AlgoritmasÄ± Entegre Edildi</p>

    <div class="main-wrapper">
        
        <div class="card">
            <h3>âš™ï¸ Parametreler</h3>
            
            <label>TÃ¼p BasÄ±ncÄ± (Bar)</label>
            <input type="number" id="pressure" value="300" placeholder="300">

            <label>TÃ¼p Hacmi (Litre)</label>
            <input type="number" id="volume" value="9" placeholder="9">

            <label>NozÃ¼l BoÄŸaz Ã‡apÄ± (mm)</label>
            <input type="number" id="diameter" value="2.0" step="0.1" placeholder="2.0">

            <label>NozÃ¼l SayÄ±sÄ±</label>
            <input type="number" id="count" value="4">

            <div style="background:#f1f5f9; padding:10px; border-radius:6px; font-size:0.8rem; color:#475569;">
                <strong>Algoritma Sabitleri:</strong><br>
                - Gaz: Kuru Hava (M=0.02897)<br>
                - Verim Ã‡arpanÄ±: 0.8<br>
                - SÄ±caklÄ±k: 293 K (20Â°C)
            </div>

            <button onclick="calculateUserCode()">HESAPLA</button>
        </div>

        <div class="card">
            <h3>ğŸ“Š Hesap Sonucu</h3>
            
            <div class="result-box">
                <div class="small-val">Toplam Ä°tki Kuvveti</div>
                <div class="big-val" id="thrustN">0 N</div>
                <div class="small-val">â‰ˆ <span id="thrustKg">0</span> kgf</div>
            </div>

            <h4 style="margin-top:20px;">ğŸ›’ Uygun Load Cell SeÃ§imi:</h4>
            <div class="links" id="linkBox">
                <div style="text-align:center; color:#94a3b8;">Hesaplama bekleniyor...</div>
            </div>
        </div>

        <div class="card full-col">
            <h3>ğŸ“ˆ SimÃ¼lasyon GrafiÄŸi</h3>
            <div style="height: 300px;">
                <canvas id="chart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // --- GRAFÄ°K KURULUMU ---
        const ctx = document.getElementById('chart').getContext('2d');
        let myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Ä°tki (N)',
                    data: [],
                    borderColor: '#f97316',
                    backgroundColor: 'rgba(249, 115, 22, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });

        // --- SENÄ°N PYTHON KODUNUN JS VERSÄ°YONU ---
        function calculateUserCode() {
            // 1. Girdileri Al
            const P_bar = parseFloat(document.getElementById('pressure').value);
            const V_lt = parseFloat(document.getElementById('volume').value);
            const D_mm = parseFloat(document.getElementById('diameter').value);
            const Count = parseFloat(document.getElementById('count').value);

            // Sabitler (Python kodundaki gibi)
            const T_K = 293;
            const P_dis_bar = 1;
            const R_universal = 8.314; // J/molÂ·K
            const M = 0.02897; // kg/mol
            const gamma = 1.4;

            // 2. Birim DÃ¶nÃ¼ÅŸÃ¼mleri
            const p = P_bar * 100000; // Bar -> Pascal
            const p_dis = P_dis_bar * 100000;
            const r = (D_mm / 1000.0) / 2; // YarÄ±Ã§ap (metre)
            const A = Math.PI * Math.pow(r, 2); // Alan (m2)

            // 3. Hava Ã–zellikleri HesabÄ± (Fonksiyon iÃ§i mantÄ±k)
            // rho = (p_Pa * M) / (R_universal * T_K)
            const rho = (p * M) / (R_universal * T_K);

            // 4. Ã‡Ä±kÄ±ÅŸ HÄ±zÄ± ve KÃ¼tle Debisi (Kodundaki MantÄ±k)
            const p0 = p;
            const p_exit = p_dis;

            // Chen FormÃ¼lÃ¼ benzeri terim hesabÄ±
            // term = ((2 / (gamma - 1)) * (1 - (p_exit / p0)**((gamma - 1) / gamma)))**0.5
            let term = Math.pow(
                (2 / (gamma - 1)) * (1 - Math.pow(p_exit / p0, (gamma - 1) / gamma)), 
                0.5
            );

            // v_exit = term * math.sqrt(gamma * R_universal / M * sicaklik_K)
            const v_exit = term * Math.sqrt(gamma * (R_universal / M) * T_K);

            // m_dot = rho * A * v_exit
            // NOT: Burada tank yoÄŸunluÄŸunu kullanÄ±yoruz (Senin koduna sadÄ±k kaldÄ±k)
            const m_dot = rho * A * v_exit;

            // F = m_dot * v_exit
            let F_single = m_dot * v_exit;

            // Verim KatsayÄ±sÄ±
            const verim = 0.8;
            F_single = F_single * verim;

            // 5. Toplam Ä°tki (NozÃ¼l sayÄ±sÄ± ile Ã§arp)
            const F_total = F_single * Count;
            const F_kg = F_total / 9.81;

            // 6. SonuÃ§larÄ± YazdÄ±r
            document.getElementById('thrustN').innerText = F_total.toFixed(2) + " N";
            document.getElementById('thrustKg').innerText = F_kg.toFixed(2);

            // 7. Load Cell Linkleri
            generateLinks(F_kg);

            // 8. GrafiÄŸi GÃ¼ncelle
            updateChart(F_total);
        }

        function generateLinks(kg) {
            const container = document.getElementById('linkBox');
            container.innerHTML = "";
            
            // Standart Kapasite SeÃ§imi
            const standards = [10, 20, 50, 100, 200, 500, 1000, 2000, 5000];
            let target = standards.find(s => s >= (kg * 2)); // GÃ¼venlik katsayÄ±sÄ± 2x
            if(!target) target = "5000+";

            const links = [
                { name: `Robotistan (${target}kg)`, url: `https://www.robotistan.com/arama?q=load+cell` },
                { name: `DirenÃ§.net (${target}kg)`, url: `https://www.direnc.net/arama?q=load+cell` },
                { name: `Google AlÄ±ÅŸveriÅŸ (${target}kg)`, url: `https://www.google.com/search?tbm=shop&q=load+cell+${target}kg` }
            ];

            links.forEach(l => {
                const a = document.createElement('a');
                a.href = l.url;
                a.target = "_blank";
                a.className = 'shop-btn';
                a.innerHTML = `<span>${l.name}</span> <span>ğŸ”—</span>`;
                container.appendChild(a);
            });
        }

        function updateChart(peakForce) {
            // Blow-down simÃ¼lasyonu
            const labels = [];
            const data = [];
            let f = peakForce;
            for(let t=0; t<=10; t+=0.5) {
                labels.push(t);
                data.push(f);
                f = f * 0.85; // Her adÄ±mda basÄ±nÃ§/itki azalÄ±r
            }
            myChart.data.labels = labels;
            myChart.data.datasets[0].data = data;
            myChart.update();
        }
    </script>
</body>
</html>
